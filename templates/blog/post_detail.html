{% extends "base.html" %}
{% block title %}{{ post.title }}{% endblock %}
{% block content %}
<article>
  <h2>{{ post.title }}</h2>
  <p>
    Categorias:
    {% for cat in post.categories.all %}
      <a href="{% url 'blog:category_detail' cat.pk %}">{{ cat.name }}</a>{% if not forloop.last %}, {% endif %}
    {% empty %}
      <span>Sem categorias</span>
    {% endfor %}
  </p>
  <p><small>{{ post.created_at|date:"SHORT_DATETIME_FORMAT" }}</small></p>
  <div>{{ post.content|safe }}</div>
  <p>
    <a href="{% url 'blog:post_edit' post.pk %}">Editar</a> |
    <a href="{% url 'blog:post_delete' post.pk %}">Remover</a> |
    <a href="{% url 'blog:post_create' %}">Criar</a> |
    <a href="{% url 'blog:comment_create' post.pk %}">Adicionar comentário</a> |
    <a href="{% url 'blog:post_list' %}">Voltar</a>
  </p>
</article>

<h3>Comentários</h3>

{% if post.comments.all %}
    {% for c in post.comments.all|dictsortreversed:"created_at" %}
        <p><b>{{ c.author.username }}</b> — {{ c.created_at|date:"SHORT_DATETIME_FORMAT" }}</p>
        <p>{{ c.text }}</p>
        <hr>
    {% endfor %}
{% else %}
    <p>Sem comentários.</p>
{% endif %}

<p><a href="{% url 'blog:comment_create' post.pk %}">Adicionar comentário</a></p>
{% endblock %}
